# 进程管理

进程是正在执行的一个程序或命令，每一个进程都是一个运行的实体，都有自己的地址空间，并占用一定的系统资源

#### 进程管理

* 判断服务器的健康状态
* 查看系统中的所有进程
* 杀死进程

## 查看所有进程

### ps

```javascript
ps aux          // 查看系统中所有进程，使用BSD操作系统格式
ps -le          // 查看系统中所有进程，使用Linux标准命令格式
```

选项
* `a` 显示一个终端的所有进程，出来会话引线
* `u` 显示进程的归属用户及内存的使用情况
* `x` 显示没有控制终端的进程
* `-l` 长格式显示，显示更加详细的信息
* `-e` 显示所有进程，和-A作用一致

命令输出

* `USER` 该进程是由哪个用户产生的
* `PID` 进程的ID号
* `%CPU` 该进程占用CPU资源的百分比
* `%MEM` 该进程占用物理内存的百分比
* `VSZ` 该进程占用虚拟内存的大小，单位KB
* `RSS` 该进程占用实际物理内存的大小，单位KB
* `TTY` 该进程是在哪个终端中运行的。其中tty1-tty7代表本地控制台终端，tty1-tty6是本地的字符界面终端，tty7是图形终端。pts/0-255代表虚拟终端
* `STAT` 该程状态
    * `R` 运行
    * `S` 睡眠
    * `T` 停止状态
    * `s` 包含子进程
    * `+` 位于后台
* `START` 该进程的启动时间
* `TIME` 该进程占用CPU的运算时间，注意不是系统时间
* `COMMAND` 产生此进程的命令名

### pstree

查看进程树

```
pstree [选项]
```

选项
* `-p` 显示进程的PID
* `-u` 显示进程的所属用户

## 查看系统状态

实时查看系统状态，3秒刷新一次

```
top [选项]
```

选项

* `-d` 秒数，指定top命令每隔几秒更新。默认是3秒
* `-b` 使用批处理模式输出。一般和 "-n" 选项合用
* `-n` 次数，指定top命令执行的次数。一般和 "-b" 选项合用

在top命令的交互模式中可以执行的命令：

* `?或h` 显示交互模式的帮助
* `P` 以CPU使用率排序，默认就是此项
* `M` 以内存使用率排序
* `N` 以PID排序
* `q` 退出top

top命令显示内容

| <div style="width:187px">内容</div> | 说明                               |
|:-----------------------------|:------------------------------------------|
| 12:23:46                     | 系统当前时间                              |
| up 1 day, 13:32              | 系统的运行时间，本机已运行1天13小时32分钟 |
| 2 users                      | 当前登录了两个用户                        |
| load average: 0.00 0.00 0.00 | 系统在之前1分钟、5分钟、15分钟的平均负载。一般认为小于1时，负载较小。如果大于1，系统已经超出负荷 |
| Tasks: 95 total              | 系统中的进程总数                          |
| 1 running                    | 正在运行的进程数                          |
| 94 sleeping                  | 睡眠的进程                                |
| 0 stopped                    | 正在停止的进程                            |
| 0 zombie                     | 僵尸进程，即卡死的进程                    |
| Cpu(s): 0.1%us               | 用户欧式占用的CPU百分比                   |
| 0.1%sy                       | 系统模式占用的CPU百分比                   |
| 0.0%ni                       | 改变过优先级的用户进程占用的CPU百分比     |
| 99.7%id                      | 空闲CPU的百分比                           |
| 0.1%wa                       | 等待输入/输出的进程的占用CPU百分比        |
| 0.0%hi                       | 硬中断请求服务占用的CPU百分比             |
| 0.1%si                       | 软中断请求服务占用的CPU百分比             |
| 0.0%st                       | st(steal time)虚拟时间百分比。就是当有虚拟机时，虚拟CPU等待实际CPU的时间百分比 |
| Mem: 625344k total           | 物理内存的总量，单位KB                    |
| 57150k used                  | 已经使用的物理内存数量                    |
| 53840k free                  | 空闲的物理内存数量                        |
| 65800k buffers               | 作为缓冲的内存数量                        |
| Swap: 524280k total          | 交换分区（虚拟内存）的总大小              |
| 0k used                      | 已经使用的交互分区的大小                  |
| 524280k free                 | 空闲交换分区的大小                        |
| 409280k cached               | 作为缓存的交互分区的大小                  |